(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-1ddaf02d"],{"0798":function(t,e,a){"use strict";a("0c18");var s=a("10d2"),i=a("afdd"),r=a("9d26"),l=a("f2e7"),n=a("7560"),o=a("2b0e"),c=o["a"].extend({name:"transitionable",props:{mode:String,origin:String,transition:String}}),d=a("58df"),u=a("d9bd");e["a"]=Object(d["a"])(s["a"],l["a"],c).extend({name:"v-alert",props:{border:{type:String,validator(t){return["top","right","bottom","left"].includes(t)}},closeLabel:{type:String,default:"$vuetify.close"},coloredBorder:Boolean,dense:Boolean,dismissible:Boolean,closeIcon:{type:String,default:"$cancel"},icon:{default:"",type:[Boolean,String],validator(t){return"string"===typeof t||!1===t}},outlined:Boolean,prominent:Boolean,text:Boolean,type:{type:String,validator(t){return["info","error","success","warning"].includes(t)}},value:{type:Boolean,default:!0}},computed:{__cachedBorder(){if(!this.border)return null;let t={staticClass:"v-alert__border",class:{["v-alert__border--"+this.border]:!0}};return this.coloredBorder&&(t=this.setBackgroundColor(this.computedColor,t),t.class["v-alert__border--has-color"]=!0),this.$createElement("div",t)},__cachedDismissible(){if(!this.dismissible)return null;const t=this.iconColor;return this.$createElement(i["a"],{staticClass:"v-alert__dismissible",props:{color:t,icon:!0,small:!0},attrs:{"aria-label":this.$vuetify.lang.t(this.closeLabel)},on:{click:()=>this.isActive=!1}},[this.$createElement(r["a"],{props:{color:t}},this.closeIcon)])},__cachedIcon(){return this.computedIcon?this.$createElement(r["a"],{staticClass:"v-alert__icon",props:{color:this.iconColor}},this.computedIcon):null},classes(){const t={...s["a"].options.computed.classes.call(this),"v-alert--border":Boolean(this.border),"v-alert--dense":this.dense,"v-alert--outlined":this.outlined,"v-alert--prominent":this.prominent,"v-alert--text":this.text};return this.border&&(t["v-alert--border-"+this.border]=!0),t},computedColor(){return this.color||this.type},computedIcon(){return!1!==this.icon&&("string"===typeof this.icon&&this.icon?this.icon:!!["error","info","success","warning"].includes(this.type)&&"$"+this.type)},hasColoredIcon(){return this.hasText||Boolean(this.border)&&this.coloredBorder},hasText(){return this.text||this.outlined},iconColor(){return this.hasColoredIcon?this.computedColor:void 0},isDark(){return!(!this.type||this.coloredBorder||this.outlined)||n["a"].options.computed.isDark.call(this)}},created(){this.$attrs.hasOwnProperty("outline")&&Object(u["a"])("outline","outlined",this)},methods:{genWrapper(){const t=[this.$slots.prepend||this.__cachedIcon,this.genContent(),this.__cachedBorder,this.$slots.append,this.$scopedSlots.close?this.$scopedSlots.close({toggle:this.toggle}):this.__cachedDismissible],e={staticClass:"v-alert__wrapper"};return this.$createElement("div",e,t)},genContent(){return this.$createElement("div",{staticClass:"v-alert__content"},this.$slots.default)},genAlert(){let t={staticClass:"v-alert",attrs:{role:"alert"},on:this.listeners$,class:this.classes,style:this.styles,directives:[{name:"show",value:this.isActive}]};if(!this.coloredBorder){const e=this.hasText?this.setTextColor:this.setBackgroundColor;t=e(this.computedColor,t)}return this.$createElement("div",t,[this.genWrapper()])},toggle(){this.isActive=!this.isActive}},render(t){const e=this.genAlert();return this.transition?t("transition",{props:{name:this.transition,origin:this.origin,mode:this.mode}},[e]):e}})},"0c18":function(t,e,a){},"38fc":function(t,e,a){"use strict";a("97f8")},6205:function(t,e,a){"use strict";a.r(e);var s=a("0798"),i=a("8336"),r=a("b0af"),l=a("99d9"),n=a("a523"),o=a("169a"),c=a("132d"),d=a("ba0d"),u=a("8654"),h=function(){var t,e,a,h=this,p=h._self._c;h._self._setupProxy;return p(n["a"],[p("div",{staticClass:"player-container"},[p("div",{staticClass:"video-container"},[p("youtube",{ref:"youtube",staticClass:"youtube-player",attrs:{"video-id":"","player-vars":h.playerVars,fitParent:!0,resize:!0},on:{playing:h.playing,paused:h.paused,ended:h.ended}})],1),p("div",{staticClass:"player-controls"},[p("div",{staticClass:"track-controls"},[p(i["a"],{staticClass:"btn-favorite",attrs:{icon:"",small:"",color:h.playingTrack&&h.playingTrack.isFavorite?"red":""},on:{click:h.toggleFavorite}},[p(c["a"],{attrs:{size:"20"}},[h._v(h._s(h.playingTrack&&h.playingTrack.isFavorite?"mdi-heart":"mdi-heart-outline"))])],1),p("div",{staticClass:"track-info"},[p("div",{staticClass:"track-title"},[h._v(" "+h._s(null===(t=h.playingTrack)||void 0===t?void 0:t.title)+" / "+h._s(null===(e=h.playingTrack)||void 0===e?void 0:e.artist)+" ")]),p("div",{staticClass:"track-singer"},[h._v(" "+h._s(null===(a=h.playingTrack)||void 0===a?void 0:a.singer)+" ")])]),p("div",{staticClass:"volume-control"},[p("div",{staticClass:"volume-slider"},[p(d["a"],{attrs:{max:"100",min:"0",dark:""},model:{value:h.volume,callback:function(t){h.volume=t},expression:"volume"}})],1),p(i["a"],{staticClass:"btn-volume",attrs:{icon:"",small:""},on:{click:h.toggleMute}},[p(c["a"],{attrs:{size:"20"}},[h._v(h._s(h.volumeIcon))])],1)],1)],1),p("div",{staticClass:"seekbar-container"},[p("div",{staticClass:"track-elapsed-time"},[h._v(" "+h._s(h.secondsToTime(h.seekbarValue/h.seekbarMax*h.trackDuration))+" ")]),p(d["a"],{staticClass:"seekbar",attrs:{"track-color":"accent lighten-1",color:"accent",min:"0",max:h.seekbarMax},on:{start:h.seekStart,end:h.seekEnd,click:h.seekEnd},model:{value:h.seekbarValue,callback:function(t){h.seekbarValue=t},expression:"seekbarValue"}}),p("div",{staticClass:"track-duration"},[h._v(" "+h._s(h.secondsToTime(h.trackDuration-h.seekbarValue/h.seekbarMax*h.trackDuration))+" ")])],1),p("div",{staticClass:"player-control-buttons"},[p("div",{staticClass:"btn-skip-previous"},[p(i["a"],{attrs:{icon:""},on:{click:h.playPrev}},[p(c["a"],{attrs:{size:"30"}},[h._v("mdi-skip-previous")])],1)],1),p("div",{staticClass:"btn-play-pause"},[1!==h.playerState?p(i["a"],{attrs:{icon:"",large:""},on:{click:h.playVideo}},[p(c["a"],{attrs:{size:"50"}},[h._v("mdi-play")])],1):p(i["a"],{attrs:{icon:"",large:""},on:{click:h.pauseVideo}},[p(c["a"],{attrs:{size:"50"}},[h._v("mdi-pause")])],1)],1),p("div",{staticClass:"btn-skip-next"},[p(i["a"],{attrs:{icon:"",rounded:""},on:{click:function(t){return h.playNext()}}},[p(c["a"],{attrs:{size:"30"}},[h._v("mdi-skip-next")])],1)],1)])])]),p("div",{staticClass:"tracklist-container scroll-thin"},[h.playlistName?p("div",{staticClass:"playlist-info"},[p(c["a"],[h._v("mdi-playlist-music")]),p("span",{staticClass:"playlist-name"},[h._v(" "+h._s(h.playlistName)+" ")]),p(o["a"],{attrs:{"max-width":"450"},scopedSlots:h._u([{key:"activator",fn:function({on:t,attrs:e}){return[p(i["a"],h._g(h._b({attrs:{icon:""}},"v-btn",e,!1),t),[p(c["a"],[h._v("mdi-download")])],1)]}}],null,!1,2449913585),model:{value:h.savePlaylistDialog,callback:function(t){h.savePlaylistDialog=t},expression:"savePlaylistDialog"}},[p(r["a"],[p(l["d"],[h._v("プレイリストを保存")]),h.newPlaylistErrorMessage?p(s["a"],{attrs:{type:h.newPlaylistErrorMessage.type},on:{click:function(t){h.newPlaylistErrorMessage=null}}},[h._v(" "+h._s(h.newPlaylistErrorMessage.text)+" ")]):h._e(),p(l["c"],[p(u["a"],{attrs:{label:"プレイリスト名",outlined:""},model:{value:h.newPlaylistName,callback:function(t){h.newPlaylistName=t},expression:"newPlaylistName"}})],1),p(l["a"],[p(i["a"],{attrs:{text:"",color:"blue"},on:{click:h.savePlaylist}},[h._v(" 保存 ")]),p(i["a"],{attrs:{text:""},on:{click:function(t){h.savePlaylistDialog=!1}}},[h._v(" キャンセル ")])],1)],1)],1)],1):h._e(),p("ul",{staticClass:"track-list"},h._l(h.tracks,(function(t){var e;return p("li",{key:t.uuid,staticClass:"track-container",class:{nowPlayingTrack:h.isNowPlaying(t)}},[p("Track",{attrs:{track:t,deletable:!1,nowPlayingId:null===(e=h.playingTrack)||void 0===e?void 0:e.id,queueing:!1,nohandle:!0},on:{clicked:h.loadTrack}})],1)})),0)])])},p=[],y=a("2b0e"),v=a("2f62"),k=a("e0ec"),m=a.n(k),g=a("2d40"),b=a("a735"),_=a("9080"),f=a("18df");const w=new _["a"]("error","プレイリスト名が空欄です");y["a"].use(m.a);var T=y["a"].extend({name:"SharedPlayer",components:{Track:()=>a.e("chunk-63bbf1b8").then(a.bind(null,"cd26"))},data(){return{playerVars:{autoplay:0,controls:0,fs:0,rel:0,enablejsapi:1,origin:window.location.origin},playerState:-1,trackDuration:0,trackCurrentTime:0,trackProgress:0,seekbarValue:0,seekbarMax:1e3,nowSeeking:!1,trackPlayed:!1,playingTrack:null,processId:null,savePlaylistDialog:!1,newPlaylistName:"",newPlaylistErrorMessage:null}},computed:{...Object(v["d"])(["playerVolume","playerMute"]),player(){const t=this.$refs.youtube;return t.player},tracks:{get(){const t=this.$route.query;let e=[];try{const a=(t.tracks?t.tracks.split("-"):[]).map(t=>parseInt(t));e=b["a"].getTracksByIds(a)}catch(a){window.alert("Invalid track ids")}return e}},playlistName:{get(){const t=this.$route.query;return t.name}},trackTimeOnSeekbar(){if(!this.playingTrack)return 0;const t=this.seekbarValue/this.seekbarMax,e=t*this.trackDuration,a=this.playingTrack.start+e;return a},volume:{get(){return this.playerVolume},set(t){this.setPlayerVolume(t)}},volumeIcon(){return this.playerMute||0===this.playerVolume?"mdi-volume-mute":this.playerVolume<20?"mdi-volume-low":this.playerVolume<80?"mdi-volume-medium":"mdi-volume-high"}},methods:{...Object(v["c"])({addFavoriteTrack:g["a"],removeFavoriteTrack:g["h"],setPlayerVolume:g["n"],setPlayerMute:g["l"],addPlaylist:g["c"],addMessage:g["b"]}),async loadTrack(t){this.playingTrack=t,await this.player.loadVideoById({videoId:t.video.id,startSeconds:t.start,endSeconds:t.end}),this.trackDuration=t.end-t.start},async playing(){this.playingTrack&&(this.trackPlayed=!0,this.trackDuration=this.playingTrack.end-this.playingTrack.start,this.processId=setInterval(()=>{this.playingTrack&&this.player.getCurrentTime().then(t=>{this.videoCurrentTime=t;const e=t-this.playingTrack.start,a=e/this.trackDuration;this.trackProgress=a<1?a:1,this.nowSeeking||(this.seekbarValue=this.seekbarMax*this.trackProgress)})},100))},paused(){null!==this.processId&&clearInterval(this.processId)},ended(){this.videoPlayed&&(this.videoPlayed=!1,this.setNextTrack())},async playVideo(){this.playingTrack?(-1===this.playerState&&await this.loadTrack(this.playingTrack),await this.player.playVideo()):this.playNext()},async pauseVideo(){await this.player.pauseVideo()},playNext(){},playPrev(){},seekStart(){this.nowSeeking=!0},async seekEnd(){this.nowSeeking=!1,await this.player.seekTo(this.trackTimeOnSeekbar,!0)},secondsToTime(t){return Object(f["b"])(t)},toggleFavorite(){this.playingTrack&&(this.playingTrack.isFavorite?(this.removeFavoriteTrack(this.playingTrack),this.playingTrack.isFavorite=!1):(this.addFavoriteTrack(this.playingTrack),this.playingTrack.isFavorite=!0))},async toggleMute(){this.setPlayerMute(!this.playerMute)},isNowPlaying(t){if(!this.playingTrack)return!1;let e=!1;return e="uuid"===this.nowPlayingId?t.uuid===this.playingTrack.uuid:t.id===this.playingTrack.id,e},savePlaylist(){if(!this.newPlaylistName)return void(this.newPlaylistErrorMessage=w.message);const t=this.newPlaylistName,e=this.tracks,a={name:t,tracks:e};try{this.addPlaylist(a)}catch(s){return void(this.newPlaylistErrorMessage=new _["a"]("error",s.message))}this.savePlaylistDialog=!1,this.addMessage(new _["a"]("info",`プレイリスト「${t}」を保存しました`))}},async mounted(){this.newPlaylistName=this.playlistName,await this.$nextTick(()=>{this.player.addEventListener("onStateChange",t=>{this.playerState=t.data})}),this.tracks.length>0&&await this.loadTrack(this.tracks[0])},watch:{async playingTrack(){if(!this.playingTrack)return null!==this.processId&&clearInterval(this.processId),await this.player.stopVideo(),void await this.player.loadVideoById("");await this.loadTrack(this.playingTrack),await this.player.setVolume(this.playerVolume),this.playerMute?await this.player.mute():await this.player.unMute(),await this.player.playVideo()},async playerVolume(){await this.player.setVolume(this.playerVolume)},async playerMute(){this.playerMute?await this.player.mute():await this.player.unMute()}}}),C=T,P=(a("38fc"),a("2877")),x=Object(P["a"])(C,h,p,!1,null,"7a6f9f69",null);e["default"]=x.exports},"97f8":function(t,e,a){},"99d9":function(t,e,a){"use strict";a.d(e,"a",(function(){return r})),a.d(e,"b",(function(){return l})),a.d(e,"c",(function(){return n})),a.d(e,"d",(function(){return o}));var s=a("b0af"),i=a("80d2");const r=Object(i["i"])("v-card__actions"),l=Object(i["i"])("v-card__subtitle"),n=Object(i["i"])("v-card__text"),o=Object(i["i"])("v-card__title");s["a"]},afdd:function(t,e,a){"use strict";var s=a("8336");e["a"]=s["a"]}}]);
//# sourceMappingURL=chunk-1ddaf02d.65277865.js.map